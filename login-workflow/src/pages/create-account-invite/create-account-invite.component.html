<!-- Error State -->
<ng-container *ngIf="!isValidRegistrationLink && !isLoading">
    <div class="mat-title pxb-auth-title">License Agreement</div>
    <div class="pxb-create-account-invite-content-error-state">
        <!-- TODO: How should we handle error states? -->
        <pxb-empty-state title="Error" description="There was an error during account registration.">
            <mat-icon pxb-empty-icon>error</mat-icon>
        </pxb-empty-state>
    </div>
    <mat-divider class="pxb-auth-divider" style="margin-bottom: 16px;"></mat-divider>
    <div class="pxb-auth-action-button-container">
        <button mat-flat-button color="primary" (click)="navigateToLogin()" [style.width.%]="100">Okay</button>
    </div>
</ng-container>

<ng-container *ngIf="isValidRegistrationLink">
    <pxb-create-account-eula-step
        *ngIf="registrationUtils.getCurrentPage() === 0 && isValidRegistrationLink"
        [(userAcceptsEula)]="userAcceptsEula"
    ></pxb-create-account-eula-step>

    <pxb-create-account-create-password-step
        *ngIf="registrationUtils.getCurrentPage() === 1"
        [(password)]="password"
        [(passwordMeetsRequirements)]="passwordMeetsRequirements"
        (advance)="attemptContinue()"
    ></pxb-create-account-create-password-step>

    <!-- Page 1 -->
    <pxb-create-account-account-details-step
        *ngIf="registrationUtils.isFirstAccountDetailsPage()"
        [showDefaultAccountDetails]="true"
        [(firstName)]="firstName"
        [(lastName)]="lastName"
        (accountNameValid)="validAccountName = $event"
        (advance)="attemptContinue()"
    >
        <template
            pxb-account-details
            [ngTemplateOutlet]="registrationUtils.getCustomAccountDetailsTemplate()"
        ></template>
    </pxb-create-account-account-details-step>

    <!-- Custom Account Details Pages -->
    <pxb-create-account-account-details-step *ngIf="registrationUtils.isCustomAccountsDetailsPage()">
        <template
            pxb-account-details
            [ngTemplateOutlet]="registrationUtils.getCustomAccountDetailsTemplate()"
        ></template>
    </pxb-create-account-account-details-step>

    <pxb-create-account-account-created-step
        *ngIf="registrationUtils.showAccountCreatedPage()"
        [userName]="getUserName()"
    ></pxb-create-account-account-created-step>

    <mat-divider class="pxb-auth-divider" style="margin-bottom: 16px;"></mat-divider>
    <div class="pxb-auth-action-button-container">
        <ng-container *ngIf="!registrationUtils.showAccountCreatedPage()">
            <pxb-mobile-stepper
                [steps]="registrationUtils.getNumberOfSteps()"
                [activeStep]="registrationUtils.getCurrentPage()"
            >
                <button pxb-back-button mat-stroked-button color="primary" style="width: 100px;" (click)="goBack()">
                    Back
                </button>
                <button
                    pxb-next-button
                    mat-flat-button
                    color="primary"
                    style="width: 100px;"
                    [disabled]="!canContinue()"
                    (click)="goNext()"
                >
                    Next
                </button>
            </pxb-mobile-stepper>
        </ng-container>
        <button
            *ngIf="registrationUtils.showAccountCreatedPage()"
            mat-flat-button
            color="primary"
            (click)="navigateToLogin()"
            style="width: 100%"
        >
            Continue
        </button>
    </div>
</ng-container>
