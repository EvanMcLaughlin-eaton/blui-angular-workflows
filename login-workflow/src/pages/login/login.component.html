<div class="pxb-login-header">
    <div #header>
        <ng-content select="[pxb-login-header]"></ng-content>
    </div>
    <div *ngIf="isEmpty(headerEl)">DEFAULT HEADER</div>
</div>

<button
    *ngIf="pxbAuthConfig.allowDebugMode"
    mat-raised-button
    class="pxb-login-debug-button"
    color="primary"
    (click)="toggleDebugMode()"
>
    {{ translate.LOGIN.ENABLE_DEBUG_MODE }}
</button>

<div *ngIf="debugMode" class="pxb-login-debug-message">
    <div class="mat-title">{{ translate.LOGIN.DEBUG_MODE }}</div>
</div>

<form>
    <mat-form-field appearance="fill">
        <mat-label>{{ translate.GENERAL.EMAIL_FORM_LABEL }}</mat-label>
        <input
            (focus)="touchedIdField = true; idFieldActive = true"
            (blur)="idFieldActive = false"
            id="pxb-email"
            name="email"
            type="email"
            matInput
            [formControl]="emailFormControl"
            autocomplete="off"
            (keyup.enter)="pxbFormsService.advanceToNextField(passwordInputElement)"
        />
        <mat-error
            *ngIf="
                isLoginFormDirty() &&
                emailFormControl.hasError('email') &&
                !emailFormControl.hasError('required') &&
                !emailFormControl.hasError(customErrorName)
            "
        >
            {{ translate.GENERAL.EMAIL_INVALID_ERROR }}
        </mat-error>
        <mat-error *ngIf="isLoginFormDirty() && emailFormControl.hasError(customErrorName)">
            {{ emailFormControl.errors[customErrorName].message }}
        </mat-error>
        <mat-error
            *ngIf="isLoginFormDirty() && emailFormControl.hasError('required')"
            [innerHTML]="translate.GENERAL.IS_REQUIRED_ERROR(translate.GENERAL.EMAIL_FORM_LABEL)"
        >
        </mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
        <mat-label>{{ translate.GENERAL.PASSWORD_FORM_LABEL }}</mat-label>
        <input
            #pxbPassword
            id="pxb-password"
            name="password"
            matInput
            [type]="isPasswordVisible ? 'text' : 'password'"
            [formControl]="passwordFormControl"
            autocomplete="off"
            (keydown.enter)="isValidFormEntries() ? login() : ''"
        />
        <button type="button" mat-icon-button matSuffix (click)="togglePasswordVisibility()">
            <mat-icon>{{ isPasswordVisible ? 'visibility' : 'visibility_off' }}</mat-icon>
        </button>
    </mat-form-field>
</form>

<div class="pxb-login-remember-me-login-wrapper">
    <mat-checkbox
        *ngIf="pxbAuthConfig.showRememberMe"
        class="pxb-login-remember-me-checkbox"
        [(ngModel)]="rememberMe"
        (change)="emitRememberMeChange()"
        >{{ translate.LOGIN.REMEMBER_ME }}</mat-checkbox
    >
    <button
        mat-flat-button
        color="primary"
        class="pxb-login-button"
        [class.pxb-login-button-full-width]="!pxbAuthConfig.showRememberMe"
        (click)="login()"
        [disabled]="isLoading || !isValidFormEntries()"
    >
        {{ translate.GENERAL.LOGIN_BUTTON }}
    </button>
</div>

<div
    *ngIf="debugMode && pxbAuthConfig.showResetPassword"
    class="pxb-auth-link mat-body-2"
    (click)="testForgotPasswordEmail()"
>
    {{ translate.LOGIN.FORGOT_PASSWORD_LINK }}
</div>
<div
    *ngIf="debugMode && pxbAuthConfig.showCreateAccountViaInvite"
    class="pxb-auth-link mat-body-2"
    (click)="testInviteRegister()"
>
    {{ translate.LOGIN.TEST_INVITE_LINK }}
</div>
<div
    *ngIf="pxbAuthConfig.showForgotPassword"
    class="pxb-auth-link mat-body-2"
    (click)="forgotPassword()"
    style="margin-bottom: 32px"
>
    {{ translate.LOGIN.FORGOT_PASSWORD }}
</div>

<div
    *ngIf="debugMode || pxbAuthConfig.showCreateAccount || pxbAuthConfig.showContactSupport"
    class="mat-body-2"
    style="text-align: center;"
>
    {{ translate.LOGIN.NEED_AN_ACCOUNT }}
</div>

<div
    *ngIf="pxbAuthConfig.showCreateAccount"
    class="pxb-auth-link mat-body-2"
    style="margin-bottom: 32px"
    (click)="createAccount()"
>
    {{ translate.LOGIN.CREATE_ACCOUNT }}
</div>

<div
    *ngIf="pxbAuthConfig.showContactSupport"
    class="pxb-auth-link mat-body-2"
    (click)="contactSupport()"
    style="margin-bottom: 32px"
>
    {{ translate.LOGIN.CONTACT_SUPPORT }}
</div>

<pxb-spacer></pxb-spacer>

<div class="pxb-login-footer">
    <div #footer>
        <ng-content select="[pxb-login-footer]"></ng-content>
    </div>
    <div *ngIf="isEmpty(footerEl)">DEFAULT FOOTER</div>
</div>
